using Microsoft.AspNetCore.Mvc;
using pentest_challenge.Contracts;
using pentest_challenge.Models;

namespace pentest_challenge.Controllers
{
    public class FlagController : BaseController
    {
        private ITokenValidator _tokenValidator;

        public FlagController(ITokenValidator tokenValidator) : base(tokenValidator)
        {
            _tokenValidator = tokenValidator;
        }
        
        [HttpGet("/flag")]
        public IActionResult Flag()
        {
            CheckForLoggedIn();
            CheckForAdmin();
            if (UserToken.Admin)
            {
                return View();
            }

            return LocalRedirect("/");
        }
    }
}