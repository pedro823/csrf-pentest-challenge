using pentest_challenge.Models;

namespace pentest_challenge.Contracts
{
    public interface ITokenStorage
    {
        TokenInformation Check(string token);
        bool Store(string token, string user, bool isAdmin);
        bool Invalidate(string token);
        bool IsToken(string token);
    }

    public class TokenResult
    {
        public readonly bool Valid;
        public readonly string User;
        public readonly string Token;
        public readonly bool Admin;

        public TokenResult(bool valid, string user, string token, bool admin)
        {
            Valid = valid;
            User = user;
            Token = token;
            Admin = admin;
        }
    }

    public interface ITokenValidator
    {
        TokenResult Validate(string token);
    }
}